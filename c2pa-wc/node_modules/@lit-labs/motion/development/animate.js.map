{"version":3,"file":"animate.js","sourceRoot":"","sources":["../src/animate.ts"],"names":[],"mappings":"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","sourcesContent":["import {LitElement, ReactiveControllerHost} from 'lit';\nimport {nothing, AttributePart} from 'lit/html.js';\nimport {directive, PartInfo, PartType} from 'lit/directive.js';\nimport {AsyncDirective} from 'lit/async-directive.js';\nimport {controllerMap} from './animate-controller.js';\nexport {AnimateController} from './animate-controller.js';\n\nexport type CSSValues = {\n  [index: string]: string | number;\n};\n\nexport type CSSPropertiesList = string[];\n\n// zIndex for \"in\" animations\nlet z = 0;\n\nconst disconnectedProps: Map<unknown, CSSValues> = new Map();\nconst renderedHosts: WeakSet<ReactiveControllerHost> = new WeakSet();\n\nexport type Options = {\n  // Options used for the animation\n  keyframeOptions?: KeyframeAnimationOptions;\n  // List of css properties to animate\n  properties?: CSSPropertiesList;\n  // if `true`, the `animate` is disabled\n  disabled?: boolean;\n  // Callback run to produce a value which is dirty checked to determine if animation should run.\n  guard?: () => unknown;\n  // Id for this `animate`; used to link to other `animate`s via e.g. `inId`\n  id?: unknown;\n  // Set to the `animate` id to map to when rendering \"in\"\n  inId?: unknown;\n  // Keyframes to use when animating \"in\"\n  in?: Keyframe[];\n  // Keyframes to use when animating \"out\"\n  out?: Keyframe[];\n  // Set to true to match DOM position when animating \"out\"\n  stabilizeOut?: boolean;\n  // Skips animation when initially rendering\n  skipInitial?: boolean;\n  // Callback run when the `animate` animation starts\n  onStart?: (animate: Animate) => void;\n  // Callback run when the animation is complete\n  onComplete?: (animate: Animate) => void;\n  // Callback run to modify frames used to animate\n  onFrames?: (animate: Animate) => Keyframe[] | undefined;\n};\n\nexport const animationFrame = () =>\n  new Promise((resolve) => requestAnimationFrame(resolve));\n\n// Presets for animating \"in\" and \"out\" of the DOM.\nexport const flyBelow = [{transform: 'translateY(100%) scale(0)', opacity: 0}];\nexport const flyAbove = [{transform: 'translateY(-100%) scale(0)', opacity: 0}];\nexport const flyLeft = [{transform: 'translateX(-100%) scale(0)', opacity: 0}];\nexport const flyRight = [{transform: 'translateX(100%) scale(0)', opacity: 0}];\nexport const none = [{}];\nexport const fadeOut = [{opacity: 0}];\nexport const fade = fadeOut;\nexport const fadeIn = [{opacity: 0}, {opacity: 1}];\nexport const fadeInSlow = [\n  {opacity: 0},\n  {opacity: 0.25, offset: 0.75},\n  {opacity: 1},\n];\n\nconst diffOp = (a: number, b: number) => {\n  const v = a - b;\n  return v === 0 ? undefined : v;\n};\nconst quotientOp = (a: number, b: number) => {\n  const v = a / b;\n  return v === 1 ? undefined : v;\n};\n\n// Computes a transform given a before and after input for given properties.\nexport const transformProps = {\n  left: (a: number, b: number) => {\n    const value = diffOp(a, b);\n    return {value, transform: value && `translateX(${value}px)`};\n  },\n  top: (a: number, b: number) => {\n    const value = diffOp(a, b);\n    return {value, transform: value && `translateY(${value}px)`};\n  },\n  width: (a: number, b: number) => {\n    const value = quotientOp(a, b);\n    return {value, transform: value && `scaleX(${value})`};\n  },\n  height: (a: number, b: number) => {\n    const value = quotientOp(a, b);\n    return {value, transform: value && `scaleY(${value})`};\n  },\n};\n\nexport const defaultKeyframeOptions: KeyframeAnimationOptions = {\n  duration: 333,\n  easing: `ease-in-out`,\n};\n\nexport const defaultCssProperties: CSSPropertiesList = [\n  'left',\n  'top',\n  'width',\n  'height',\n  'opacity',\n  'color',\n  'background',\n];\n\n// Dirty checks the value received from the `guard` option.\nconst isDirty = (value: unknown, previous: unknown) => {\n  if (Array.isArray(value)) {\n    // Dirty-check arrays by item\n    if (\n      Array.isArray(previous) &&\n      previous.length === value.length &&\n      value.every((v, i) => v === (previous as Array<unknown>)[i])\n    ) {\n      return false;\n    }\n  } else if (previous === value) {\n    // Dirty-check non-arrays by identity\n    return false;\n  }\n  return true;\n};\n\n// Mapping of node on which the `animate` directive is used to the `animate` directive.\n// Used to get the ancestor `animate` animations (which are used to modify\n// `animate` transforms), done by ascending the DOM.\nconst nodeToAnimateMap: WeakMap<Node, Animate> = new WeakMap();\n\n/**\n * `animate` directive class. Animates a node's position between renders.\n */\nexport class Animate extends AsyncDirective {\n  private _host?: LitElement;\n  private _fromValues?: CSSValues;\n  private _parentNode: Element | null = null;\n  private _nextSibling: Node | null = null;\n  private _shouldAnimate = true;\n  private _previousValue: unknown;\n  private _styles?: string | undefined | null;\n  element!: HTMLElement;\n\n  shouldLog = false;\n  animatingProperties?: CSSValues;\n  frames?: Keyframe[];\n  webAnimation?: Animation;\n  options!: Options;\n  optionsOrCallback?: (() => Options) | Options;\n\n  finished!: Promise<void>;\n  private _resolveFinished?: () => void;\n\n  constructor(part: PartInfo) {\n    super(part);\n    if (part.type === PartType.CHILD) {\n      throw new Error(\n        'The `animate` directive must be used in attribute position.'\n      );\n    }\n    this.createFinished();\n  }\n\n  createFinished() {\n    this.resolveFinished?.();\n    this.finished = new Promise((r) => {\n      this._resolveFinished = r;\n    });\n  }\n\n  async resolveFinished() {\n    this._resolveFinished?.();\n    this._resolveFinished = undefined;\n  }\n\n  render(_options?: (() => Options) | Options) {\n    return nothing;\n  }\n\n  getController() {\n    return controllerMap.get(this._host!);\n  }\n\n  isDisabled() {\n    return this.options.disabled || this.getController()?.disabled;\n  }\n\n  override update(part: AttributePart, [options]: Parameters<this['render']>) {\n    const firstUpdate = this._host === undefined;\n    if (firstUpdate) {\n      this._host = part.options?.host as LitElement;\n      this._host.addController(this);\n      this.element = part.element;\n      nodeToAnimateMap.set(this.element, this);\n    }\n    this.optionsOrCallback = options;\n    if (firstUpdate || typeof options !== 'function') {\n      this._setOptions(options as Options);\n    }\n    return this.render(options);\n  }\n\n  // TODO(sorvell): instead of a function/object, just use an object that the\n  // user can mutate and create accessors for the data that do lookups as needed.\n  // We're doing this every hostUpdate anyway and these lookups are fast.\n  private _setOptions(options?: Options) {\n    options = options ?? {};\n    // Mixin controller options.\n    const controller = this.getController();\n    if (controller !== undefined) {\n      options = {\n        ...controller.defaultOptions,\n        ...options,\n      };\n      options.keyframeOptions = {\n        ...controller.defaultOptions.keyframeOptions,\n        ...options.keyframeOptions,\n      };\n    }\n    // Ensure there are some properties to animation and some animation options.\n    options!.properties ??= defaultCssProperties;\n    this.options = options;\n  }\n\n  // Measures and returns metrics for the element's bounding box and styling\n  private _measure() {\n    const props: CSSValues = {};\n    const bounds = this.element.getBoundingClientRect();\n    const computedStyle = getComputedStyle(this.element);\n    this.options.properties!.forEach((p) => {\n      const v =\n        bounds[p as keyof typeof bounds] ??\n        (!transformProps[p as keyof typeof transformProps]\n          ? computedStyle[p as keyof CSSStyleDeclaration]\n          : undefined);\n      const asNum = Number(v);\n      props[p] = isNaN(asNum) ? String(v) : asNum;\n    });\n    return props;\n  }\n\n  // Returns true if a `animate` should be started.\n  private _canStart() {\n    let dirty = true,\n      value = undefined;\n    if (this.options.guard) {\n      value = this.options.guard();\n      dirty = isDirty(value, this._previousValue);\n    }\n    this._shouldAnimate =\n      this._host!.hasUpdated &&\n      !this.isDisabled() &&\n      !this.isAnimating() &&\n      dirty &&\n      this.element.isConnected;\n    if (this._shouldAnimate) {\n      // Copy the value if it's an array so that if it's mutated we don't forget\n      // what the previous values were.\n      this._previousValue = Array.isArray(value) ? Array.from(value) : value;\n    }\n    return this._shouldAnimate;\n  }\n\n  hostUpdate() {\n    // TODO(sorvell): If options will change that will affect measuring,\n    // then the user must pass a callback which can be called at update time.\n    if (typeof this.optionsOrCallback === 'function') {\n      this._setOptions(this.optionsOrCallback());\n    }\n    if (this._canStart()) {\n      this._fromValues = this._measure();\n      // Record parent and nextSibling used to re-attach node when animating \"out\"\n      this._parentNode =\n        this._parentNode ?? (this.element.parentNode as Element);\n      this._nextSibling = this.element.nextSibling;\n    }\n  }\n\n  async hostUpdated() {\n    if (\n      !this._shouldAnimate ||\n      !this.element.isConnected ||\n      (this.options.skipInitial && !this.isHostRendered)\n    ) {\n      return;\n    }\n    this.prepare();\n    // Wait for rendering so any sub-elements have a chance to render.\n    await animationFrame;\n    let frames: Keyframe[] | undefined;\n    const ancestors = this._getAncestors();\n    // These inherit from ancestors. This allows easier synchronization of\n    // child `animate`s within ancestor `animate`s.\n    const animationOptions = this._calculateKeyframeOptions(\n      this.options.keyframeOptions,\n      ancestors\n    );\n    const toValues = this._measure();\n    // Normal or inverse scale\n    if (this._fromValues !== undefined) {\n      const {from, to} = this._applyAncestorAdjustments(\n        this._fromValues,\n        toValues,\n        ancestors\n      );\n      this.log('measured', [this._fromValues, toValues, from, to]);\n      frames = this.calculateKeyframes(from, to);\n      // \"In\" `animate`.\n    } else {\n      const disconnected = disconnectedProps.get(this.options.inId);\n      if (disconnected) {\n        // use disconnected data only once.\n        disconnectedProps.delete(this.options.inId);\n        const {from, to} = this._applyAncestorAdjustments(\n          disconnected!,\n          toValues,\n          ancestors\n        );\n        frames = this.calculateKeyframes(from, to);\n        // \"merge\" with \"in\" frames\n        frames = this.options.in\n          ? [\n              {...this.options.in[0], ...frames![0]},\n              ...this.options.in.slice(1),\n              frames![1],\n            ]\n          : frames;\n        // adjust z so always on top...\n        z++;\n        frames!.forEach((f) => (f.zIndex = z));\n      } else if (this.options.in) {\n        frames = [...this.options.in, {}];\n      }\n    }\n    this.animate(frames, animationOptions);\n  }\n\n  resetStyles() {\n    if (this._styles !== undefined) {\n      this.element.setAttribute('style', this._styles ?? '');\n      this._styles = undefined;\n    }\n  }\n\n  commitStyles() {\n    this._styles = this.element.getAttribute('style');\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (this.webAnimation as any)?.commitStyles();\n    this.webAnimation?.cancel();\n  }\n\n  override reconnected() {}\n\n  // Experimental animate out functionality.\n  override async disconnected() {\n    if (!this._shouldAnimate) {\n      return;\n    }\n    if (this.options.id !== undefined) {\n      disconnectedProps.set(this.options.id, this._fromValues!);\n    }\n    if (this.options.out === undefined) {\n      return;\n    }\n    this.prepare();\n    await animationFrame();\n    if (this._parentNode?.isConnected) {\n      // put element back in DOM\n      const ref =\n        this._nextSibling && this._nextSibling.parentNode === this._parentNode\n          ? this._nextSibling\n          : null;\n      this._parentNode.insertBefore(this.element, ref);\n      // Optionally move element back to its position before it was detached.\n      if (this.options.stabilizeOut) {\n        // Measure current position after re-attaching.\n        const shifted = this._measure();\n        this.log('stabilizing out');\n        // TODO(sorvell): these nudges could conflict with existing styling\n        // or animation but setting left/top should be rare, especially via\n        // animation.\n        const left =\n          (this._fromValues!.left as number) - (shifted.left as number);\n        const top = (this._fromValues!.top as number) - (shifted.top as number);\n        const isStatic = getComputedStyle(this.element).position === 'static';\n        if (isStatic && (left !== 0 || top !== 0)) {\n          this.element.style.position = 'relative';\n        }\n        if (left !== 0) {\n          this.element.style.left = left + 'px';\n        }\n        if (top !== 0) {\n          this.element.style.top = top + 'px';\n        }\n      }\n    }\n    // These inherit from ancestors. This allows easier synchronization of\n    // child `animate`s within ancestor `animate`s.\n    const keyframeOptions = this._calculateKeyframeOptions(\n      this.options.keyframeOptions\n    );\n    await this.animate(this.options.out, keyframeOptions);\n    this.element.remove();\n  }\n\n  prepare() {\n    this.createFinished();\n  }\n\n  start() {\n    this.options.onStart?.(this);\n  }\n\n  didFinish(didAnimate: boolean) {\n    if (didAnimate) {\n      this.options.onComplete?.(this);\n    }\n    this._fromValues = undefined;\n    this.animatingProperties = undefined;\n    this.frames = undefined;\n    this.resolveFinished();\n  }\n\n  private _getAncestors() {\n    const ancestors = [];\n    for (\n      let p: Node | null | undefined = this.element.parentNode;\n      p;\n      p = p?.parentNode\n    ) {\n      const a = nodeToAnimateMap.get(p!);\n      if (a && !a.isDisabled() && a) {\n        ancestors.push(a);\n      }\n    }\n    return ancestors;\n  }\n\n  protected get isHostRendered() {\n    const hostRendered = renderedHosts.has(this._host!);\n    if (!hostRendered) {\n      this._host!.updateComplete.then(() => {\n        renderedHosts.add(this._host!);\n      });\n    }\n    return hostRendered;\n  }\n\n  private _calculateKeyframeOptions(\n    options: KeyframeAnimationOptions | undefined,\n    ancestors: Animate[] = this._getAncestors()\n  ) {\n    // merges this `animate`'s options over ancestor options over defaults\n    const keyframeOptions = {...defaultKeyframeOptions};\n    ancestors.forEach((a) =>\n      Object.assign(keyframeOptions, a.options.keyframeOptions)\n    );\n    Object.assign(keyframeOptions, options);\n    return keyframeOptions;\n  }\n\n  // Adjust position based on ancestor scaling.\n  private _applyAncestorAdjustments(\n    from: CSSValues,\n    to: CSSValues,\n    ancestors: Animate[]\n  ) {\n    from = {...from};\n    to = {...to};\n    const ancestorProps = ancestors\n      .map((a) => a.animatingProperties)\n      .filter((a) => a !== undefined) as CSSValues[];\n    let dScaleX = 1;\n    let dScaleY = 1;\n    if (ancestorProps !== undefined) {\n      // gather scaling data for ancestors\n      ancestorProps.forEach((a) => {\n        if (a.width) {\n          dScaleX = dScaleX / (a.width as number);\n        }\n        if (a.height) {\n          dScaleY = dScaleY / (a.height as number);\n        }\n      });\n      // Move position by ancestor scaling amount.\n      if (from.left !== undefined && to.left !== undefined) {\n        from.left = dScaleX * (from.left as number);\n        to.left = dScaleX * (to.left as number);\n      }\n      if (from.top !== undefined && to.top !== undefined) {\n        from.top = dScaleY * (from.top as number);\n        to.top = dScaleY * (to.top as number);\n      }\n    }\n    return {from, to};\n  }\n\n  protected calculateKeyframes(from: CSSValues, to: CSSValues, center = false) {\n    const fromFrame: Keyframe = {};\n    const toFrame: Keyframe = {};\n    let hasFrames = false;\n    const props: CSSValues = {};\n    for (const p in to) {\n      const f = from[p],\n        t = to[p];\n      if (p in transformProps) {\n        const tp = transformProps[p as keyof typeof transformProps];\n        if (f === undefined || t === undefined) {\n          continue;\n        }\n        const op = tp(f as number, t as number);\n        if (op.transform !== undefined) {\n          props[p] = op.value!;\n          hasFrames = true;\n          fromFrame.transform = `${fromFrame.transform ?? ''} ${op.transform}`;\n        }\n      } else if (f !== t && f !== undefined && t !== undefined) {\n        hasFrames = true;\n        fromFrame[p] = f;\n        toFrame[p] = t;\n      }\n    }\n    fromFrame.transformOrigin = toFrame.transformOrigin = center\n      ? 'center center'\n      : 'top left';\n    this.animatingProperties = props;\n    return hasFrames ? [fromFrame, toFrame] : undefined;\n  }\n\n  protected async animate(\n    frames: Keyframe[] | undefined,\n    options = this.options.keyframeOptions\n  ) {\n    this.start();\n    this.frames = frames;\n    let didAnimate = false;\n    if (!this.isAnimating() && !this.isDisabled()) {\n      if (this.options.onFrames) {\n        this.frames = frames = this.options.onFrames(this);\n        this.log('modified frames', frames);\n      }\n      if (frames !== undefined) {\n        this.log('animate', [frames, options]);\n        didAnimate = true;\n        this.webAnimation = this.element.animate(frames, options);\n        const controller = this.getController();\n        controller?.add(this);\n        try {\n          await this.webAnimation.finished;\n        } catch (e) {\n          // cancelled.\n        }\n        controller?.remove(this);\n      }\n    }\n    this.didFinish(didAnimate);\n    return didAnimate;\n  }\n\n  protected isAnimating() {\n    return (\n      this.webAnimation?.playState === 'running' || this.webAnimation?.pending\n    );\n  }\n\n  log(message: string, data?: unknown) {\n    if (this.shouldLog && !this.isDisabled()) {\n      console.log(message, this.options.id, data);\n    }\n  }\n}\n\n/**\n * The `animate` directive animates a node's layout between renders.\n * It will perform a \"tweening\" animation between the two states based on\n * the options given. In addition, elements can animate when they initially\n * render to DOM and when they are removed.\n *\n * Options include:\n * * animationOptions:  configure animation via standard KeyframeAnimationOptions\n * * properties: list of properties to animate, defaults to\n * ['left', 'top','width', 'height', 'opacity', 'color', 'background']\n * * disabled: disables animation\n * * guard: function producing values that must change for the `animate` to run\n * * in: keyframes to use when animating in\n * * out: keyframes to use when animating out\n * * skipInitial: skip animating in the first time\n * * id: used to link to other `animate`s via `inId`\n * * inId: id of the `animate` to render from when animating in\n * * onStart: run when the `animate` starts\n * * onComplete: run when the `animate` completes\n * * onFrames: run when the frames are produces, use to modify frames\n */\nexport const animate = directive(Animate);\n"]}